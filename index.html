<!DOCTYPE html>
<html lang="de"> <!-- Language set to German -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Title translated -->
    <title>Netzwerke bauen – Schichten und Feedforward-Struktur</title>
    <style>
        /* CSS remains the same */
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #ffffff;
            font-size: 150%;
        }
        section {
            margin-bottom: 20px;
            padding: 20px;
            background-color: #ffffff;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease-in;
        }
        h1, h2, h3, h4 {
            color: #333;
            margin-top: 20px;
        }
        p, li {
            line-height: 1.6;
            color: #444;
            margin-bottom: 20px;
        }
        ul {
            padding-left: 20px;
        }
        .image-placeholder, .interactive-placeholder, .continue-button, .vocab-section, .why-it-matters, .test-your-knowledge, .faq-section, .stop-and-think {
            text-align: left;
        }
        .image-placeholder img, .interactive-placeholder img {
            max-width: 100%;
            height: auto;
            border-radius: 5px;
        }
        .vocab-section, .why-it-matters, .test-your-knowledge, .faq-section, .stop-and-think, .math-explainer {
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .vocab-section {
            background-color: #f0f8ff;
        }
        .vocab-section h3 {
            color: #1e90ff;
            font-size: 0.75em;
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .vocab-section h4 {
            color: #000;
            font-size: 0.9em;
            margin-top: 10px;
            margin-bottom: 8px;
        }
        .vocab-term {
            font-weight: bold;
            color: #1e90ff;
        }
        .why-it-matters {
            background-color: #ffe6f0;
        }
        .why-it-matters h3 {
            color: #d81b60;
            font-size: 0.75em;
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .stop-and-think {
            background-color: #e6e6ff;
        }
        .stop-and-think h3 {
            color: #4b0082;
            font-size: 0.75em;
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .continue-button {
            display: inline-block;
            padding: 10px 20px;
            margin-top: 15px;
            color: #ffffff;
            background-color: #007bff;
            border-radius: 5px;
            text-decoration: none;
            cursor: pointer;
        }
        .reveal-button {
            display: inline-block;
            padding: 10px 20px;
            margin-top: 15px;
            color: #ffffff;
            background-color: #4b0082;
            border-radius: 5px;
            text-decoration: none;
            cursor: pointer;
        }
        .test-your-knowledge {
            background-color: #e6ffe6; /* Light green background */
        }
        .test-your-knowledge h3 {
            color: #28a745; /* Dark green heading */
            font-size: 0.75em;
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .test-your-knowledge h4 {
            color: #000;
            font-size: 0.9em;
            margin-top: 10px;
            margin-bottom: 8px;
        }
        .test-your-knowledge p {
            margin-bottom: 15px;
        }
        .check-button {
            display: inline-block;
            padding: 10px 20px;
            margin-top: 15px;
            color: #ffffff;
            background-color: #28a745; /* Green background */
            border-radius: 5px;
            text-decoration: none;
            cursor: pointer;
            border: none;
            font-size: 1em;
        }
        .faq-section {
            background-color: #fffbea; /* Light yellow background */
        }
        .faq-section h3 {
            color: #ffcc00; /* Bright yellow heading */
            font-size: 0.75em;
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .faq-section h4 {
            color: #000;
            font-size: 0.9em;
            margin-top: 10px;
            margin-bottom: 8px;
        }
        .math-explainer {
            background-color: #f5f5f5;
            border-left: 4px solid #007bff;
            padding: 20px; /* Added padding */
            border-radius: 8px; /* Added radius */
            margin-top: 20px; /* Added margin */
        }
        .math-explainer h3 {
            color: #007bff;
            font-size: 0.75em; /* Adjusted size */
            margin-bottom: 5px;
            margin-top: 5px;
        }
        .math-step {
            margin-bottom: 10px;
            padding-left: 15px;
        }
        .math-step-number {
            font-weight: bold;
            color: #007bff;
            margin-right: 5px;
        }
        .math-note {
            font-style: italic;
            margin-top: 10px;
            color: #666;
            font-size: 0.9em; /* Slightly smaller note */
        }
        .option-container {
            margin-bottom: 15px;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
        }
        .option-container:hover {
            background-color: #f9f9f9;
        }
        .option-feedback {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .correct-feedback {
            background-color: #d4edda;
            color: #155724;
        }
        .incorrect-feedback {
            background-color: #f8d7da;
            color: #721c24;
        }
         /* Style for inline MathJax */
         mjx-container {
            display: inline !important; /* Ensure MathJax behaves inline */
         }
    </style>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <section id="section1">
        <div class="image-placeholder">
            <!-- Alt text translated -->
            <img src="images/2.png?height=300&width=600" alt="Bild zeigt mehrere einzelne Neuron-Icons, die zu Schichten in einer Netzwerkstruktur verbunden werden.">
        </div>
        <!-- Header and paragraph translated -->
        <h1>Netzwerke bauen: Schichten und Feedforward-Struktur</h1>
        <p>Wir haben das künstliche Neuron kennengelernt, unsere grundlegende Verarbeitungseinheit. Aber wie im Gehirn entsteht die wahre Stärke erst durch die Verbindung vieler Neuronen. Wie organisieren wir sie? Wir ordnen sie in <strong>Schichten</strong> (Layers) an.</p>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(2)">Weiter</div>
    </section>

    <section id="section2">
        <!-- Header and paragraph translated -->
        <h2>Die Schicht-Architektur</h2>
        <p>Stell dir ein typisches Feedforward-Neuronales Netz wie eine Verarbeitungspipeline vor, die in einzelne Schichten organisiert ist.</p>
        <!-- Start: Simple Feedforward Network Diagram -->
<div id="feedforward-diagram">

    <style>
        /* Scoped styles for the Feedforward Network Diagram - Unchanged */
        #feedforward-diagram {
            padding: 20px 10px;
            background-color: #ffffff;
            font-size: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            text-align: center; /* Center SVG */
        }

        #feedforward-diagram svg {
            display: inline-block;
            width: 100%;
            max-width: 500px; /* Adjust width as needed */
            height: auto;
            overflow: visible;
            cursor: default;
            font-family: Arial, sans-serif;
        }

        /* Node Styles (using previous palette) */
        #feedforward-diagram .ff-node {
            stroke-width: 1.5;
            filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.2)); /* Subtle shadow */
        }
        #feedforward-diagram .input-node-ff { fill: #d1f7ff; stroke: #00bcd4; } /* Light Cyan */
        #feedforward-diagram .hidden-node-ff { fill: #fff5d4; stroke: #ffc107; } /* Amber */
        #feedforward-diagram .output-node-ff { fill: #fce4ec; stroke: #e91e63; } /* Pink */

         /* Line Style */
        #feedforward-diagram .connection-line-ff {
            stroke: #b0bec5; /* Lighter Blue Grey */
            stroke-width: 1.5;
            opacity: 0.8;
        }

        /* Text Styles */
        #feedforward-diagram .label-text-ff { font-size: 13px; fill: #333; text-anchor: middle; dominant-baseline: central; pointer-events: none; }
        #feedforward-diagram .layer-label-ff { font-weight: bold; font-size: 14px; fill: #546e7a; text-anchor: middle; dominant-baseline: hanging; }
        #feedforward-diagram .subscript { font-size: 0.7em; baseline-shift: sub; }
        #feedforward-diagram .superscript { font-size: 0.7em; baseline-shift: super; }

        /* Arrowhead */
        #feedforward-diagram .arrow-marker-ff polygon { fill: #b0bec5; }

    </style>

    <!-- Adjust viewBox as needed -->
    <svg id="ann-svg-feedforward" viewBox="0 0 400 250">
        <defs>
            <marker id="arrowhead-ann-ff" class="arrow-marker-ff"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" />
            </marker>
        </defs>

         <!-- Layer Labels Translated -->
         <text class="layer-label-ff" x="30" y="0">Eingabe-Schicht (L=0)</text>
         <text class="layer-label-ff" x="200" y="0">Versteckte Schicht (L=1)</text>
         <text class="layer-label-ff" x="370" y="0">Ausgabe-Schicht (L=2)</text>

         <!-- Layer 0: Inputs - Symbolic text, no change needed -->
         <g id="input-layer-ff">
            <circle class="ff-node input-node-ff" cx="50" cy="80" r="15"/>
            <text class="label-text-ff" x="50" y="80">x<tspan class="subscript">1</tspan></text>

            <circle class="ff-node input-node-ff" cx="50" cy="170" r="15"/>
             <text class="label-text-ff" x="50" y="170">x<tspan class="subscript">2</tspan></text>
         </g>

         <!-- Layer 1: Hidden - Symbolic text, no change needed -->
         <g id="hidden-layer-ff">
            <circle class="ff-node hidden-node-ff" cx="200" cy="50" r="15"/>
             <text class="label-text-ff" x="200" y="50">a<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>

            <circle class="ff-node hidden-node-ff" cx="200" cy="125" r="15"/>
             <text class="label-text-ff" x="200" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>

             <circle class="ff-node hidden-node-ff" cx="200" cy="200" r="15"/>
             <text class="label-text-ff" x="200" y="200">a<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
         </g>

         <!-- Layer 2: Output - Symbolic text, no change needed -->
         <g id="output-layer-ff">
            <circle class="ff-node output-node-ff" cx="350" cy="125" r="15"/>
            <text class="label-text-ff" x="350" y="125">a<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
         </g>

        <!-- Connections - No text, no change needed -->
        <g id="connections-ff">
            <!-- Layer 0 -> Layer 1 -->
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="50" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="125" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="200" marker-end="url(#arrowhead-ann-ff)"/>

            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="50" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="125" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="200" marker-end="url(#arrowhead-ann-ff)"/>

            <!-- Layer 1 -> Layer 2 -->
            <line class="connection-line-ff" x1="215" y1="50" x2="335" y2="125" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="215" y1="125" x2="335" y2="125" marker-end="url(#arrowhead-ann-ff)"/>
            <line class="connection-line-ff" x1="215" y1="200" x2="335" y2="125" marker-end="url(#arrowhead-ann-ff)"/>
        </g>

    </svg>

</div>
<!-- End: Simple Feedforward Network Diagram -->
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(3)">Weiter</div>
    </section>

    <section id="section3">
        <!-- Paragraph translated -->
        <p>Schauen wir uns die Haupttypen von Schichten an:</p>
        <div class="vocab-section">
            <!-- Vocab H3 translated -->
            <h3>Erweiter deinen Wortschatz</h3>
            <!-- Vocab Term and Definition translated -->
            <h4 class="vocab-term">Eingabe-Schicht (Input Layer)</h4>
            <p>Die erste Schicht eines neuronalen Netzes, die die rohen Eingabedaten (Merkmale) empfängt. Sie führt typischerweise keine Berechnungen durch, sondern leitet die Daten nur an die erste versteckte Schicht weiter.</p>
            <!-- Vocab Term and Definition translated -->
            <h4 class="vocab-term">Versteckte Schicht(en) (Hidden Layer(s))</h4>
            <p>Schichten, die sich zwischen der Eingabe- und Ausgabeschicht befinden. Neuronen in versteckten Schichten führen Berechnungen durch (gewichtete Summe + Aktivierung) und lernen Zwischenrepräsentationen der Daten. Netzwerke können keine, eine oder viele versteckte Schichten haben.</p>
            <!-- Vocab Term and Definition translated -->
            <h4 class="vocab-term">Ausgabe-Schicht (Output Layer)</h4>
            <p>Die letzte Schicht des Netzwerks, die die gewünschte Ausgabe erzeugt, z. B. Klassenwahrscheinlichkeiten für Klassifizierung oder einen kontinuierlichen Wert für Regression.</p>
        </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(4)">Weiter</div>
    </section>

    <section id="section4">
        <!-- Paragraph translated -->
        <p>Die Anzahl der Neuronen in jeder Schicht und die Anzahl der versteckten Schichten sind wichtige Designentscheidungen, die die <strong>Architektur</strong> des Netzwerks definieren.</p>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(5)">Weiter</div>
    </section>

    <section id="section5">
        <!-- Header and paragraph translated -->
        <h2>Der Feedforward-Fluss</h2>
        <p>Ist dir die Richtung der Pfeile in unserem Netzwerkdiagramm aufgefallen?</p>
        <!-- Start: Animated Feedforward Network Diagram -->
<div id="feedforward-diagram-animated">

    <style>
        /* Scoped styles for the Animated Feedforward Network Diagram - Unchanged */
        #feedforward-diagram-animated {
            padding: 20px 10px;
            background-color: #ffffff;
            font-size: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            text-align: center;
        }

        #feedforward-diagram-animated svg {
            display: inline-block;
            width: 100%;
            max-width: 500px;
            height: auto;
            overflow: visible;
            cursor: default;
            font-family: Arial, sans-serif;
        }

        /* Node Styles */
        #feedforward-diagram-animated .ff-node {
            stroke-width: 1.5;
            filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.2));
            transition: filter 0.3s ease-in-out; /* Smooth transition for potential future node highlight */
        }
        #feedforward-diagram-animated .input-node-ff { fill: #d1f7ff; stroke: #00bcd4; }
        #feedforward-diagram-animated .hidden-node-ff { fill: #fff5d4; stroke: #ffc107; }
        #feedforward-diagram-animated .output-node-ff { fill: #fce4ec; stroke: #e91e63; }

         /* Line Style */
        #feedforward-diagram-animated .connection-line-ff {
            stroke: #b0bec5; /* Base color */
            stroke-width: 1.5;
            opacity: 0.6; /* Slightly fade base lines */
            transition: stroke 0.4s ease-in-out, stroke-width 0.4s ease-in-out, opacity 0.4s ease-in-out;
        }

        /* Highlight style for arrows */
        #feedforward-diagram-animated .highlight-arrow {
            stroke: #0d47a1; /* Dark blue highlight */
            stroke-width: 3;
            opacity: 1;
        }
         /* Arrowhead style - base */
         #feedforward-diagram-animated .arrow-marker-ff polygon {
             fill: #b0bec5;
             transition: fill 0.4s ease-in-out;
         }
         /* Arrowhead style - highlighted */
         #feedforward-diagram-animated .highlight-arrow .arrow-marker-ff polygon, /* If marker is child */
         #feedforward-diagram-animated .highlight-arrow[marker-end] .arrow-marker-ff polygon /* If marker is referenced */
          {
              /* Selector might need adjustment depending on SVG structure/implementation */
              /* Targeting the polygon fill via the line's class is tricky. */
              /* Alternative: Add class directly to marker via JS, or change marker url */
              fill: #0d47a1 !important; /* Force highlight color */
         }


        /* Text Styles */
        #feedforward-diagram-animated .label-text-ff { font-size: 13px; fill: #333; text-anchor: middle; dominant-baseline: central; pointer-events: none; }
        #feedforward-diagram-animated .layer-label-ff { font-weight: bold; font-size: 14px; fill: #546e7a; text-anchor: middle; dominant-baseline: hanging; }
        #feedforward-diagram-animated .subscript { font-size: 0.7em; baseline-shift: sub; }
        #feedforward-diagram-animated .superscript { font-size: 0.7em; baseline-shift: super; }

    </style>

    <svg id="ann-svg-feedforward-animated" viewBox="0 0 400 250">
        <defs>
            <!-- Arrowhead Marker Definition -->
            <marker id="arrowhead-ff-animated" class="arrow-marker-ff"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" /> <!-- Path fill controlled by CSS -->
            </marker>
            <!-- Arrowhead Marker for Highlighted state (alternative if CSS fails) -->
             <marker id="arrowhead-ff-animated-highlight" class="arrow-marker-ff-highlight"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#0d47a1" />
            </marker>
        </defs>

         <!-- Layer Labels Translated -->
         <text class="layer-label-ff" x="30" y="0">Eingabe-Schicht (L=0)</text>
         <text class="layer-label-ff" x="200" y="0">Versteckte Schicht (L=1)</text>
         <text class="layer-label-ff" x="370" y="0">Ausgabe-Schicht (L=2)</text>

         <!-- Layer 0: Inputs -->
         <g id="input-layer-ff-animated">
            <circle class="ff-node input-node-ff" cx="50" cy="80" r="15"/>
            <text class="label-text-ff" x="50" y="80">x<tspan class="subscript">1</tspan></text>
            <circle class="ff-node input-node-ff" cx="50" cy="170" r="15"/>
            <text class="label-text-ff" x="50" y="170">x<tspan class="subscript">2</tspan></text>
         </g>

         <!-- Layer 1: Hidden -->
         <g id="hidden-layer-ff-animated">
            <circle class="ff-node hidden-node-ff" cx="200" cy="50" r="15"/>
            <text class="label-text-ff" x="200" y="50">a<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff" cx="200" cy="125" r="15"/>
            <text class="label-text-ff" x="200" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff" cx="200" cy="200" r="15"/>
            <text class="label-text-ff" x="200" y="200">a<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
         </g>

         <!-- Layer 2: Output -->
         <g id="output-layer-ff-animated">
            <circle class="ff-node output-node-ff" cx="350" cy="125" r="15"/>
            <text class="label-text-ff" x="350" y="125">a<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
         </g>

        <!-- Connections Grouped by Stage -->
        <!-- Stage 1: Layer 0 -> Layer 1 -->
        <g id="connections-ff-0-1">
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="50" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="125" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="200" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="50" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="125" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="200" marker-end="url(#arrowhead-ff-animated)"/>
        </g>

         <!-- Stage 2: Layer 1 -> Layer 2 -->
        <g id="connections-ff-1-2">
            <line class="connection-line-ff" x1="215" y1="50" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="215" y1="125" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated)"/>
            <line class="connection-line-ff" x1="215" y1="200" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated)"/>
        </g>

    </svg>

    <script>
        // JS Logic for animation remains the same
        (function() {
            const container = document.getElementById('feedforward-diagram-animated');
            if (!container) return;

            const connections01 = container.querySelector('#connections-ff-0-1');
            const connections12 = container.querySelector('#connections-ff-1-2');
            const lines01 = connections01 ? connections01.querySelectorAll('.connection-line-ff') : [];
            const lines12 = connections12 ? connections12.querySelectorAll('.connection-line-ff') : [];

            const highlightClass = 'highlight-arrow';
            const normalMarkerUrl = 'url(#arrowhead-ff-animated)';
            const highlightMarkerUrl = 'url(#arrowhead-ff-animated-highlight)'; // Use separate marker

            const stage1Duration = 1200; // ms to highlight stage 1
            const stage2Duration = 1200; // ms to highlight stage 2
            const pauseDuration = 500;   // ms pause between stages and before repeat
            const totalCycleTime = stage1Duration + pauseDuration + stage2Duration + pauseDuration;

            function animateFlow() {
                // Clear previous highlights immediately
                lines01.forEach(line => {
                    line.classList.remove(highlightClass);
                    line.setAttribute('marker-end', normalMarkerUrl);
                });
                lines12.forEach(line => {
                    line.classList.remove(highlightClass);
                    line.setAttribute('marker-end', normalMarkerUrl);
                });

                // Stage 1: Highlight Layer 0 -> Layer 1
                setTimeout(() => {
                    lines01.forEach(line => {
                        line.classList.add(highlightClass);
                        line.setAttribute('marker-end', highlightMarkerUrl); // Switch marker
                    });
                }, 0); // Start immediately

                // Stage 2: Highlight Layer 1 -> Layer 2
                setTimeout(() => {
                    // Remove stage 1 highlight
                    lines01.forEach(line => {
                        line.classList.remove(highlightClass);
                        line.setAttribute('marker-end', normalMarkerUrl);
                    });
                    // Add stage 2 highlight
                    lines12.forEach(line => {
                        line.classList.add(highlightClass);
                         line.setAttribute('marker-end', highlightMarkerUrl); // Switch marker
                    });
                }, stage1Duration + pauseDuration);

                 // End of Stage 2: Clear highlight before next cycle
                setTimeout(() => {
                    lines12.forEach(line => {
                        line.classList.remove(highlightClass);
                        line.setAttribute('marker-end', normalMarkerUrl);
                    });
                }, stage1Duration + pauseDuration + stage2Duration);
            }

            // Run the animation immediately and then repeat it
            animateFlow(); // Initial run
            setInterval(animateFlow, totalCycleTime); // Repeat cycle

        })();
    </script>

</div>
<!-- End: Animated Feedforward Network Diagram -->
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(6)">Weiter</div>
    </section>

    <section id="section6">
        <!-- Paragraph translated -->
        <p>Informationen fließen in eine Richtung: von der Eingabeschicht über die versteckte(n) Schicht(en) zur Ausgabeschicht. Es gibt keine Verbindungen, die Schleifen bilden oder Schichten überspringen, in diesem grundlegenden Netzwerktyp. Deshalb nennt man sie <strong>Feedforward Neuronale Netze</strong>.</p>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(7)">Weiter</div>
    </section>

    <section id="section7">
        <div class="faq-section">
            <!-- FAQ Header translated -->
            <h3>Häufig gestellte Fragen (FAQ)</h3>
            <!-- FAQ Question translated -->
            <h4>Gibt es Netzwerke, in denen Informationen <em>tatsächlich</em> zurückfließen?</h4>
            <!-- FAQ Answer translated -->
            <p>Ja! Netzwerke mit Rückkopplungsverbindungen oder Schleifen werden Rekurrente Neuronale Netze (RNNs) genannt. Sie sind besonders nützlich für die Verarbeitung sequenzieller Daten wie Text oder Zeitreihen, bei denen Informationen aus früheren Schritten die aktuelle Verarbeitung beeinflussen müssen. Wir haben LSTMs in Lektion 1 erwähnt – das ist ein ausgefeilter Typ von RNN. Aber fürs Erste konzentrieren wir uns auf die einfachere Feedforward-Struktur.</p>
        </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(8)">Weiter</div>
    </section>

    <section id="section8">
        <!-- Header and paragraph translated -->
        <h2>Voll verbundene Schichten</h2>
        <p>Ein weiteres gemeinsames Merkmal in diesen geschichteten Netzwerken ist, wie Neuronen zwischen benachbarten Schichten verbunden sind.</p>
        <!-- Start: Animated Feedforward Network Diagram (Specific Sequence) -->
<div id="feedforward-diagram-animated-seq">

    <style>
        /* Scoped styles for the Animated Feedforward Network Diagram (Specific Sequence) - Unchanged */
        #feedforward-diagram-animated-seq {
            padding: 20px 10px;
            background-color: #ffffff;
            font-size: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            text-align: center;
        }

        #feedforward-diagram-animated-seq svg {
            display: inline-block;
            width: 100%;
            max-width: 500px;
            height: auto;
            overflow: visible;
            cursor: default;
            font-family: Arial, sans-serif;
        }

        /* Node Styles */
        #feedforward-diagram-animated-seq .ff-node {
            stroke-width: 1.5;
            filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.2));
            transition: filter 0.3s ease-in-out;
        }
        #feedforward-diagram-animated-seq .input-node-ff { fill: #d1f7ff; stroke: #00bcd4; }
        #feedforward-diagram-animated-seq .hidden-node-ff { fill: #fff5d4; stroke: #ffc107; }
        #feedforward-diagram-animated-seq .output-node-ff { fill: #fce4ec; stroke: #e91e63; }

         /* Line Style */
        #feedforward-diagram-animated-seq .connection-line-ff {
            stroke: #b0bec5; /* Base color */
            stroke-width: 1.5;
            opacity: 0.6;
            transition: stroke 0.4s ease-in-out, stroke-width 0.4s ease-in-out, opacity 0.4s ease-in-out;
        }

        /* Highlight style for arrows */
        #feedforward-diagram-animated-seq .highlight-arrow {
            stroke: #0d47a1; /* Dark blue highlight */
            stroke-width: 3;
            opacity: 1;
        }

        /* Arrowhead Markers */
        #feedforward-diagram-animated-seq .arrow-marker-ff polygon {
            fill: #b0bec5; /* Base color */
            transition: fill 0.4s ease-in-out; /* Transition (though JS switch is primary) */
        }
        /* Highlight marker style set directly in its definition */


        /* Text Styles */
        #feedforward-diagram-animated-seq .label-text-ff { font-size: 13px; fill: #333; text-anchor: middle; dominant-baseline: central; pointer-events: none; }
        #feedforward-diagram-animated-seq .layer-label-ff { font-weight: bold; font-size: 14px; fill: #546e7a; text-anchor: middle; dominant-baseline: hanging; }
        #feedforward-diagram-animated-seq .subscript { font-size: 0.7em; baseline-shift: sub; }
        #feedforward-diagram-animated-seq .superscript { font-size: 0.7em; baseline-shift: super; }

    </style>

    <svg id="ann-svg-feedforward-animated-seq" viewBox="0 0 400 250">
        <defs>
            <!-- Default Arrowhead Marker -->
            <marker id="arrowhead-ff-animated-seq" class="arrow-marker-ff"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" />
            </marker>
            <!-- Highlighted Arrowhead Marker -->
             <marker id="arrowhead-ff-animated-seq-highlight" class="arrow-marker-ff-highlight"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" fill="#0d47a1" /> <!-- Highlight color -->
            </marker>
        </defs>

         <!-- Layer Labels Translated -->
         <text class="layer-label-ff" x="30" y="0">Eingabe-Schicht (L=0)</text>
         <text class="layer-label-ff" x="200" y="0">Versteckte Schicht (L=1)</text>
         <text class="layer-label-ff" x="370" y="0">Ausgabe-Schicht (L=2)</text>

         <!-- Layer 0: Inputs -->
         <g id="input-layer-ff-animated-seq">
            <circle class="ff-node input-node-ff" id="node-x1" cx="50" cy="80" r="15"/>
            <text class="label-text-ff" x="50" y="80">x<tspan class="subscript">1</tspan></text>
            <circle class="ff-node input-node-ff" id="node-x2" cx="50" cy="170" r="15"/>
            <text class="label-text-ff" x="50" y="170">x<tspan class="subscript">2</tspan></text>
         </g>

         <!-- Layer 1: Hidden -->
         <g id="hidden-layer-ff-animated-seq">
            <circle class="ff-node hidden-node-ff" id="node-h1" cx="200" cy="50" r="15"/>
            <text class="label-text-ff" x="200" y="50">a<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff" id="node-h2" cx="200" cy="125" r="15"/>
            <text class="label-text-ff" x="200" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff" id="node-h3" cx="200" cy="200" r="15"/>
            <text class="label-text-ff" x="200" y="200">a<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
         </g>

         <!-- Layer 2: Output -->
         <g id="output-layer-ff-animated-seq">
            <circle class="ff-node output-node-ff" id="node-o1" cx="350" cy="125" r="15"/>
            <text class="label-text-ff" x="350" y="125">a<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
         </g>

        <!-- Connections Grouped by Stage/Origin -->
        <!-- Stage 1: From x1 -->
        <g id="connections-ff-x1">
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="50" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="125" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="65" y1="80" x2="185" y2="200" marker-end="url(#arrowhead-ff-animated-seq)"/>
        </g>
        <!-- Stage 2: From x2 -->
         <g id="connections-ff-x2">
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="50" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="125" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="65" y1="170" x2="185" y2="200" marker-end="url(#arrowhead-ff-animated-seq)"/>
         </g>
         <!-- Stage 3: From Hidden Layer -->
        <g id="connections-ff-1-2">
            <line class="connection-line-ff" x1="215" y1="50" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="215" y1="125" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated-seq)"/>
            <line class="connection-line-ff" x1="215" y1="200" x2="335" y2="125" marker-end="url(#arrowhead-ff-animated-seq)"/>
        </g>

    </svg>

    <script>
        // JS Logic for animation remains the same
        (function() {
            const container = document.getElementById('feedforward-diagram-animated-seq');
            if (!container) return;

            // Get connection groups
            const connectionsX1 = container.querySelector('#connections-ff-x1');
            const connectionsX2 = container.querySelector('#connections-ff-x2');
            const connections12 = container.querySelector('#connections-ff-1-2');

            // Get lines within each group
            const linesX1 = connectionsX1 ? connectionsX1.querySelectorAll('.connection-line-ff') : [];
            const linesX2 = connectionsX2 ? connectionsX2.querySelectorAll('.connection-line-ff') : [];
            const lines12 = connections12 ? connections12.querySelectorAll('.connection-line-ff') : [];

            // Animation parameters
            const highlightClass = 'highlight-arrow';
            const normalMarkerUrl = 'url(#arrowhead-ff-animated-seq)';
            const highlightMarkerUrl = 'url(#arrowhead-ff-animated-seq-highlight)';

            const stageDuration = 1000; // ms duration for each highlight stage
            const pauseDuration = 400;   // ms pause between stages and before repeat
            const totalCycleTime = (stageDuration * 3) + (pauseDuration * 3); // 3 stages, 3 pauses

            // Helper functions to manage highlights
            function highlightGroup(lines) {
                lines.forEach(line => {
                    line.classList.add(highlightClass);
                    line.setAttribute('marker-end', highlightMarkerUrl);
                });
            }

            function clearGroup(lines) {
                lines.forEach(line => {
                    line.classList.remove(highlightClass);
                    line.setAttribute('marker-end', normalMarkerUrl);
                });
            }

             function clearAllHighlights() {
                 clearGroup(linesX1);
                 clearGroup(linesX2);
                 clearGroup(lines12);
             }

            // Animation sequence function
            function animateFlowSpecific() {
                clearAllHighlights(); // Reset at the start of each cycle

                // Stage 1: Highlight connections from x1
                setTimeout(() => {
                    highlightGroup(linesX1);
                }, 0); // Start immediately

                // Clear Stage 1 highlight after its duration
                 setTimeout(() => {
                     clearGroup(linesX1);
                 }, stageDuration);

                // Stage 2: Highlight connections from x2 (after pause)
                setTimeout(() => {
                    highlightGroup(linesX2);
                }, stageDuration + pauseDuration);

                // Clear Stage 2 highlight after its duration
                 setTimeout(() => {
                     clearGroup(linesX2);
                 }, stageDuration + pauseDuration + stageDuration);

                // Stage 3: Highlight connections from hidden layer (after pause)
                setTimeout(() => {
                    highlightGroup(lines12);
                }, stageDuration + pauseDuration + stageDuration + pauseDuration);

                // Clear Stage 3 highlight after its duration (end of visible cycle)
                setTimeout(() => {
                    clearGroup(lines12);
                }, stageDuration + pauseDuration + stageDuration + pauseDuration + stageDuration);
            }

            // Run the animation immediately and then repeat it
            animateFlowSpecific(); // Initial run
            setInterval(animateFlowSpecific, totalCycleTime); // Repeat cycle

        })();
    </script>

</div>
<!-- End: Animated Feedforward Network Diagram (Specific Sequence) -->
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(9)">Weiter</div>
    </section>

    <section id="section9">
        <!-- Paragraph translated -->
        <p>Wenn jedes Neuron in Schicht \(l-1\) mit jedem Neuron in Schicht \(l\) verbunden ist, nennen wir diese <strong>voll verbundene Schichten</strong> (oder manchmal 'dense' Layers). Dies ist ein sehr verbreitetes Verbindungsmuster, besonders in einfacheren Feedforward-Netzwerken oder Teilen komplexerer Architekturen.</p>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(10)">Weiter</div>
    </section>

    <section id="section10">
        <div class="vocab-section">
            <!-- Vocab H3 translated -->
            <h3>Erweiter deinen Wortschatz</h3>
            <!-- Vocab Term and Definition translated -->
            <h4 class="vocab-term">Voll verbundene Schicht (Fully Connected Layer)</h4>
            <p>Eine Schicht in einem neuronalen Netz, in der jedes Neuron Eingaben von <em>jedem</em> Neuron der vorherigen Schicht erhält.</p>
        </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(11)">Weiter</div>
    </section>

    <section id="section11">
        <!-- Header and paragraph translated -->
        <h2>Tiefere Netzwerke</h2>
        <p>Wir sind nicht auf nur eine versteckte Schicht beschränkt. Wir können mehrere versteckte Schichten stapeln, um <strong>tiefe neuronale Netze</strong> (Deep Neural Networks) zu erstellen.</p>
        <!-- Start: Deeper Feedforward Network Diagram -->
<div id="deep-feedforward-diagram">

    <style>
        /* Scoped styles for the Deeper Feedforward Network Diagram - Unchanged */
        #deep-feedforward-diagram {
            padding: 20px 10px;
            background-color: #ffffff;
            font-size: 100%;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
            text-align: center;
        }

        #deep-feedforward-diagram svg {
            display: inline-block;
            width: 100%;
            max-width: 700px; /* Increased width for more layers */
            height: auto;
            overflow: visible;
            cursor: default;
            font-family: Arial, sans-serif;
        }

        /* Node Styles */
        #deep-feedforward-diagram .ff-node {
            stroke-width: 1.5;
            filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.2));
        }
        #deep-feedforward-diagram .input-node-ff { fill: #d1f7ff; stroke: #00bcd4; } /* Cyan */
        #deep-feedforward-diagram .hidden1-node-ff { fill: #fff5d4; stroke: #ffc107; } /* Amber */
        #deep-feedforward-diagram .hidden2-node-ff { fill: #e8f5e9; stroke: #4caf50; } /* Green */
        #deep-feedforward-diagram .hidden3-node-ff { fill: #ede7f6; stroke: #7e57c2; } /* Deep Purple Light */
        #deep-feedforward-diagram .output-node-ff { fill: #fce4ec; stroke: #e91e63; } /* Pink */

         /* Line Style */
        #deep-feedforward-diagram .connection-line-ff {
            stroke: #b0bec5; /* Lighter Blue Grey */
            stroke-width: 1.5;
            opacity: 0.7;
        }

        /* Text Styles */
        #deep-feedforward-diagram .label-text-ff { font-size: 11px; fill: #333; text-anchor: middle; dominant-baseline: central; pointer-events: none; } /* Slightly smaller for deeper nets */
        #deep-feedforward-diagram .layer-label-ff { font-weight: bold; font-size: 14px; fill: #546e7a; text-anchor: middle; dominant-baseline: hanging; }
        #deep-feedforward-diagram .subscript { font-size: 0.7em; baseline-shift: sub; }
        #deep-feedforward-diagram .superscript { font-size: 0.7em; baseline-shift: super; }

        /* Arrowhead */
        #deep-feedforward-diagram .arrow-marker-ff polygon { fill: #b0bec5; }

    </style>

    <!-- Adjust viewBox width and height -->
    <svg id="ann-svg-deep-feedforward" viewBox="0 0 650 250">
        <defs>
            <marker id="arrowhead-ann-deep-ff" class="arrow-marker-ff"
                    viewBox="0 0 10 10" refX="10" refY="5"
                    markerUnits="strokeWidth" markerWidth="4" markerHeight="5"
                    orient="auto-start-reverse">
              <path d="M 0 0 L 10 5 L 0 10 z" />
            </marker>
        </defs>

        <!-- Constants for horizontal positioning -->
        <script>
            // JS constants unchanged
            const LAYER_X = [50, 175, 300, 425, 550]; // X coordinates for layers 0-4
            const NODE_RADIUS = 12; // Smaller radius for deeper net
        </script>

         <!-- Layer Labels Translated -->
         <text class="layer-label-ff" x="50" y="10">Eingabe (L=0)</text>
         <text class="layer-label-ff" x="175" y="10">Verst. 1 (L=1)</text>
         <text class="layer-label-ff" x="300" y="10">Verst. 2 (L=2)</text>
         <text class="layer-label-ff" x="425" y="10">Verst. 3 (L=3)</text>
         <text class="layer-label-ff" x="550" y="10">Ausgabe (L=4)</text>

         <!-- Layer 0: Inputs (2 nodes) -->
         <g id="input-layer-deep-ff">
            <circle class="ff-node input-node-ff" cx="50" cy="85" r="12"/> <text class="label-text-ff" x="50" y="85">x<tspan class="subscript">1</tspan></text>
            <circle class="ff-node input-node-ff" cx="50" cy="165" r="12"/> <text class="label-text-ff" x="50" y="165">x<tspan class="subscript">2</tspan></text>
         </g>

         <!-- Layer 1: Hidden 1 (3 nodes) -->
         <g id="hidden1-layer-deep-ff">
            <circle class="ff-node hidden1-node-ff" cx="175" cy="60" r="12"/> <text class="label-text-ff" x="175" y="60">a<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden1-node-ff" cx="175" cy="125" r="12"/> <text class="label-text-ff" x="175" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden1-node-ff" cx="175" cy="190" r="12"/> <text class="label-text-ff" x="175" y="190">a<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
         </g>

         <!-- Layer 2: Hidden 2 (3 nodes) -->
         <g id="hidden2-layer-deep-ff">
             <circle class="ff-node hidden2-node-ff" cx="300" cy="60" r="12"/> <text class="label-text-ff" x="300" y="60">a<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
             <circle class="ff-node hidden2-node-ff" cx="300" cy="125" r="12"/> <text class="label-text-ff" x="300" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(2)</tspan></text>
             <circle class="ff-node hidden2-node-ff" cx="300" cy="190" r="12"/> <text class="label-text-ff" x="300" y="190">a<tspan class="subscript">3</tspan><tspan class="superscript">(2)</tspan></text>
         </g>

         <!-- Layer 3: Hidden 3 (2 nodes) -->
         <g id="hidden3-layer-deep-ff">
            <circle class="ff-node hidden3-node-ff" cx="425" cy="85" r="12"/> <text class="label-text-ff" x="425" y="85">a<tspan class="subscript">1</tspan><tspan class="superscript">(3)</tspan></text>
            <circle class="ff-node hidden3-node-ff" cx="425" cy="165" r="12"/> <text class="label-text-ff" x="425" y="165">a<tspan class="subscript">2</tspan><tspan class="superscript">(3)</tspan></text>
         </g>

         <!-- Layer 4: Output (1 node) -->
         <g id="output-layer-deep-ff">
            <circle class="ff-node output-node-ff" cx="550" cy="125" r="12"/>
            <text class="label-text-ff" x="550" y="125">a<tspan class="subscript">1</tspan><tspan class="superscript">(4)</tspan></text>
         </g>

        <!-- Connections - No text, no change needed -->
        <g id="connections-deep-ff">
            <!-- L0 -> L1 -->
            <line class="connection-line-ff" x1="62" y1="85" x2="163" y2="60" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="62" y1="85" x2="163" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="62" y1="85" x2="163" y2="190" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="62" y1="165" x2="163" y2="60" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="62" y1="165" x2="163" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="62" y1="165" x2="163" y2="190" marker-end="url(#arrowhead-ann-deep-ff)"/>

            <!-- L1 -> L2 -->
            <line class="connection-line-ff" x1="187" y1="60" x2="288" y2="60" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="60" x2="288" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="60" x2="288" y2="190" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="125" x2="288" y2="60" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="125" x2="288" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="125" x2="288" y2="190" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="190" x2="288" y2="60" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="190" x2="288" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="187" y1="190" x2="288" y2="190" marker-end="url(#arrowhead-ann-deep-ff)"/>

            <!-- L2 -> L3 -->
            <line class="connection-line-ff" x1="312" y1="60" x2="413" y2="85" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="312" y1="60" x2="413" y2="165" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="312" y1="125" x2="413" y2="85" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="312" y1="125" x2="413" y2="165" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="312" y1="190" x2="413" y2="85" marker-end="url(#arrowhead-ann-deep-ff)"/>
            <line class="connection-line-ff" x1="312" y1="190" x2="413" y2="165" marker-end="url(#arrowhead-ann-deep-ff)"/>

             <!-- L3 -> L4 -->
             <line class="connection-line-ff" x1="437" y1="85" x2="538" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
             <line class="connection-line-ff" x1="437" y1="165" x2="538" y2="125" marker-end="url(#arrowhead-ann-deep-ff)"/>
        </g>

    </svg>

</div>
<!-- End: Deeper Feedforward Network Diagram -->
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(12)">Weiter</div>
    </section>

    <section id="section12">
        <!-- Paragraph translated -->
        <p>Mehrere versteckte Schichten ermöglichen es dem Netzwerk, Merkmale hierarchisch zu lernen. Frühe Schichten könnten einfache Muster aus der Eingabe lernen, während spätere Schichten diese einfachen Muster kombinieren, um komplexere Konzepte zu erkennen. Diese Fähigkeit ist ein Schlüsselgrund für den Erfolg des Deep Learning.</p>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(13)">Weiter</div>
    </section>

    <section id="section13">
        <div class="why-it-matters">
            <!-- Header translated -->
            <h3>Warum ist das wichtig?</h3>
            <!-- Paragraph translated -->
            <p>Die Tiefe eines Netzwerks (Anzahl der Schichten) ist ein entscheidender Aspekt seiner Architektur. Tiefere Netzwerke können oft komplexere Funktionen effizienter lernen als flache Netzwerke mit der gleichen Gesamtzahl an Neuronen, obwohl sie auch schwieriger zu trainieren sein können.</p>
        </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(14)">Weiter</div>
    </section>

    <section id="section14">
        <!-- Header and paragraphs translated -->
        <h2>Notation für Netzwerke</h2>
        <p>Da Netzwerke größer werden, brauchen wir eine präzise Notation, um den Überblick zu behalten.</p>
        <p>Verfeinern wir die Notation, die wir für ein einzelnes Neuron eingeführt haben:</p>
        <div class="math-explainer">
            <!-- Header translated -->
            <h3>Netzwerk-Notation</h3>
            <!-- Math steps translated, LaTeX kept -->
            <div class="math-step">
                <span class="math-step-number">1.</span> Wir nummerieren die Schichten beginnend mit \(l = 0\) für die Eingabeschicht.
            </div>
            <div class="math-step">
                <span class="math-step-number">2.</span> \(a_j^{(l)}\): Repräsentiert die <strong>Aktivierung</strong> (Ausgabe) des \(j\)-ten Neurons in Schicht \(l\).
            </div>
            <div class="math-step">
                <span class="math-step-number">3.</span> \(b_j^{(l)}\): Repräsentiert den <strong>Bias</strong> des \(j\)-ten Neurons in Schicht \(l\).
            </div>
            <div class="math-step">
                <span class="math-step-number">4.</span> \(w_{ij}^{(l)}\): Repräsentiert das <strong>Gewicht</strong> der Verbindung <em>vom</em> Neuron \(i\) in der <em>vorherigen</em> Schicht (\(l - 1\)) <em>zum</em> Neuron \(j\) in der <em>aktuellen</em> Schicht (\(l\)).
            </div>
            <!-- Math note translated -->
            <div class="math-note">
                Achte genau auf die Indizes für das Gewicht \(w_{ij}^{(l)}\): \(i\) ist der Index in der <em>Quell</em>-Schicht (\(l - 1\)), \(j\) ist der Index in der <em>Ziel</em>-Schicht (\(l\)), und \(l\) bezieht sich auf die Schicht, in die das Gewicht <em>hineingeht</em>.
            </div>
        </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(15)">Weiter</div>
    </section>

    <section id="section15">
<!-- Paragraph translated -->
        <p>Nutze das interaktive Diagramm, um dich mit der Notation vertraut zu machen. Zu verstehen, wohin jedes Gewicht und jeder Bias gehört, ist entscheidend für den nächsten Schritt: die effiziente Berechnung der Aktivierungen für eine ganze Schicht mithilfe von Matrizen.</p>
        <!-- Button text translated -->

        <!-- Start: Interactive Network Diagram Navigator (Labeled - Spaced v2) -->
<div id="interactive-ann-navigator-labeled-spaced-v2">

    <style>
        /* Scoped styles (remain the same as previous version) */
        #interactive-ann-navigator-labeled-spaced-v2 { padding: 15px; background-color: #ffffff; font-size: 100%; border-radius: 8px; margin-bottom: 20px; text-align: center; }
        #interactive-ann-navigator-labeled-spaced-v2 svg { display: inline-block; width: 100%; max-width: 550px; height: auto; overflow: visible; cursor: default; font-family: Arial, sans-serif; margin-bottom: 15px; }
        #interactive-ann-navigator-labeled-spaced-v2 .interactive-element { cursor: pointer; }
        #interactive-ann-navigator-labeled-spaced-v2 .ff-node { stroke-width: 1.5; filter: drop-shadow(0px 1px 1px rgba(0,0,0,0.2)); transition: stroke 0.2s ease, stroke-width 0.2s ease; }
        #interactive-ann-navigator-labeled-spaced-v2 .input-node-ff { fill: #d1f7ff; stroke: #00bcd4; }
        #interactive-ann-navigator-labeled-spaced-v2 .hidden-node-ff { fill: #fff5d4; stroke: #ffc107; }
        #interactive-ann-navigator-labeled-spaced-v2 .output-node-ff { fill: #fce4ec; stroke: #e91e63; }
        #interactive-ann-navigator-labeled-spaced-v2 .connection-line-ff { stroke: #b0bec5; stroke-width: 1.5; opacity: 0.7; transition: stroke 0.2s ease, stroke-width 0.2s ease, opacity 0.2s ease; }
        #interactive-ann-navigator-labeled-spaced-v2 .connection-click-target { stroke: transparent; stroke-width: 10; cursor: pointer; }
        #interactive-ann-navigator-labeled-spaced-v2 .bias-arrow-ff { stroke: #757575; stroke-width: 1; opacity: 0.8; transition: stroke 0.2s ease, stroke-width 0.2s ease, opacity 0.2s ease; }
        #interactive-ann-navigator-labeled-spaced-v2 .highlight.ff-node { stroke: #0d47a1; stroke-width: 3.5; }
        #interactive-ann-navigator-labeled-spaced-v2 .highlight.connection-line-ff { stroke: #0d47a1; stroke-width: 3; opacity: 1; }
        #interactive-ann-navigator-labeled-spaced-v2 .highlight.bias-label-ff { fill: #f57f17; font-weight: bold; }
        #interactive-ann-navigator-labeled-spaced-v2 .highlight.bias-arrow-ff { stroke: #f57f17; stroke-width: 2; opacity: 1; }
        #interactive-ann-navigator-labeled-spaced-v2 .highlight.weight-label-ff { fill: #0d47a1; font-weight: bold; }
        #interactive-ann-navigator-labeled-spaced-v2 .marker-default polygon { fill: #b0bec5; }
        #interactive-ann-navigator-labeled-spaced-v2 .marker-highlight polygon { fill: #0d47a1; }
        #interactive-ann-navigator-labeled-spaced-v2 .marker-bias-arrow polygon { fill: #757575; }
        #interactive-ann-navigator-labeled-spaced-v2 .marker-bias-arrow-highlight polygon { fill: #f57f17; }
        #interactive-ann-navigator-labeled-spaced-v2 .label-text-ff { font-size: 13px; fill: #333; text-anchor: middle; dominant-baseline: central; pointer-events: none; }
        #interactive-ann-navigator-labeled-spaced-v2 .layer-label-ff { font-weight: bold; font-size: 14px; fill: #546e7a; text-anchor: middle; dominant-baseline: hanging; }
        #interactive-ann-navigator-labeled-spaced-v2 .subscript { font-size: 0.7em; baseline-shift: sub; }
        #interactive-ann-navigator-labeled-spaced-v2 .superscript { font-size: 0.7em; baseline-shift: super; }
        #interactive-ann-navigator-labeled-spaced-v2 .weight-label-ff,
        #interactive-ann-navigator-labeled-spaced-v2 .bias-label-ff { font-size: 10px; font-family: 'Times New Roman', Times, serif; font-style: italic; fill: #546e7a; text-anchor: middle; transition: fill 0.2s ease, font-weight 0.2s ease; cursor: pointer; } /* Added cursor */
        #interactive-ann-navigator-labeled-spaced-v2 .bias-label-ff { dominant-baseline: auto; }
        #interactive-ann-navigator-labeled-spaced-v2 #description-interactive-ann-labeled-spaced-v2 { padding: 15px 20px; margin: 0 15px 15px 15px; background-color: #f8f9fa; border-radius: 5px; min-height: 3em; text-align: left; color: #444; line-height: 1.6; font-size: 1em; transition: background-color 0.3s ease; }
        #interactive-ann-navigator-labeled-spaced-v2 #description-interactive-ann-labeled-spaced-v2 strong { color: #333; font-weight: bold; }
         /* MathJax Code Style */
        #interactive-ann-navigator-labeled-spaced-v2 #description-interactive-ann-labeled-spaced-v2 mjx-container[jax="CHTML"] {
            font-family: monospace !important; /* Use monospace font */
            background-color: #e9ecef;
            padding: 0.1em 0.4em;
            border-radius: 3px;
            font-size: 0.95em; /* Match original code size */
            display: inline !important; /* Ensure it stays inline */
        }
    </style>

    <svg id="ann-svg-interactive-labeled-spaced-v2" viewBox="0 0 400 270">
        <defs>
             <!-- Markers -->
             <marker id="arrowhead-labeled-spaced-v2-default" class="marker-default" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="4" markerHeight="5" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" /></marker>
             <marker id="arrowhead-labeled-spaced-v2-highlight" class="marker-highlight" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="4" markerHeight="5" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" /></marker>
             <marker id="arrowhead-bias-spaced-v2-default" class="marker-bias-arrow" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="5" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" /></marker>
             <marker id="arrowhead-bias-spaced-v2-highlight" class="marker-bias-arrow-highlight" viewBox="0 0 10 10" refX="10" refY="5" markerUnits="strokeWidth" markerWidth="5" markerHeight="6" orient="auto-start-reverse"><path d="M 0 0 L 10 5 L 0 10 z" /></marker>
        </defs>

         <!-- Layer Labels Translated -->
         <text class="layer-label-ff" x="30" y="0">Eingabe-Schicht (L=0)</text>
         <text class="layer-label-ff" x="200" y="0">Versteckte Schicht (L=1)</text>
         <text class="layer-label-ff" x="370" y="0">Ausgabe-Schicht (L=2)</text>

         <!-- Layer 0: Inputs -->
         <g id="input-layer-interactive-labeled-spaced-v2">
            <circle class="ff-node input-node-ff interactive-element" id="node-x1-labeled-spaced-v2" cx="50" cy="80" r="15"/> <text class="label-text-ff" x="50" y="80">x<tspan class="subscript">1</tspan></text>
            <circle class="ff-node input-node-ff interactive-element" id="node-x2-labeled-spaced-v2" cx="50" cy="170" r="15"/> <text class="label-text-ff" x="50" y="170">x<tspan class="subscript">2</tspan></text>
         </g>

         <!-- Layer 1: Hidden -->
         <g id="hidden-layer-interactive-labeled-spaced-v2">
            <circle class="ff-node hidden-node-ff interactive-element" id="node-h1-labeled-spaced-v2" cx="200" cy="50" r="15"/> <text class="label-text-ff" x="200" y="50">a<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff interactive-element" id="node-h2-labeled-spaced-v2" cx="200" cy="125" r="15"/> <text class="label-text-ff" x="200" y="125">a<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>
            <circle class="ff-node hidden-node-ff interactive-element" id="node-h3-labeled-spaced-v2" cx="200" cy="200" r="15"/> <text class="label-text-ff" x="200" y="200">a<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
         </g>

         <!-- Layer 2: Output -->
         <g id="output-layer-interactive-labeled-spaced-v2">
            <circle class="ff-node output-node-ff interactive-element" id="node-o1-labeled-spaced-v2" cx="350" cy="125" r="15"/> <text class="label-text-ff" x="350" y="125">a<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
         </g>

        <!-- Bias Labels and Arrows -->
        <g id="bias-elements-labeled-spaced-v2">
             <text class="bias-label-ff interactive-element" id="bias-h1-label-spaced-v2" x="170" y="30">b<tspan class="subscript">1</tspan><tspan class="superscript">(1)</tspan></text>
             <line class="bias-arrow-ff" id="bias-h1-arrow-spaced-v2" x1="180" y1="35" x2="190" y2="42" marker-end="url(#arrowhead-bias-spaced-v2-default)"/>
             <text class="bias-label-ff interactive-element" id="bias-h2-label-spaced-v2" x="170" y="110">b<tspan class="subscript">2</tspan><tspan class="superscript">(1)</tspan></text>
             <line class="bias-arrow-ff" id="bias-h2-arrow-spaced-v2" x1="180" y1="115" x2="190" y2="119" marker-end="url(#arrowhead-bias-spaced-v2-default)"/>
             <text class="bias-label-ff interactive-element" id="bias-h3-label-spaced-v2" x="170" y="185">b<tspan class="subscript">3</tspan><tspan class="superscript">(1)</tspan></text>
             <line class="bias-arrow-ff" id="bias-h3-arrow-spaced-v2" x1="180" y1="190" x2="190" y2="194" marker-end="url(#arrowhead-bias-spaced-v2-default)"/>
             <text class="bias-label-ff interactive-element" id="bias-o1-label-spaced-v2" x="320" y="110">b<tspan class="subscript">1</tspan><tspan class="superscript">(2)</tspan></text>
             <line class="bias-arrow-ff" id="bias-o1-arrow-spaced-v2" x1="330" y1="115" x2="340" y2="119" marker-end="url(#arrowhead-bias-spaced-v2-default)"/>
        </g>

        <!-- Connections and Weight Labels (More Aggressive Spacing) -->
        <g id="connections-labeled-spaced-v2">
            <!-- Layer 0 -> Layer 1 -->
            <line class="connection-line-ff" id="line-x1-h1-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="50" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
            <text class="weight-label-ff interactive-element" id="weight-x1-h1-label-spaced-v2" x="110" y="60">w<tspan class="subscript">11</tspan><tspan class="superscript">(1)</tspan></text> <!-- Above line -->

            <line class="connection-line-ff" id="line-x1-h2-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="125" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-x1-h2-label-spaced-v2" x="130" y="95">w<tspan class="subscript">12</tspan><tspan class="superscript">(1)</tspan></text> <!-- Below line, shifted right -->

            <line class="connection-line-ff" id="line-x1-h3-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="200" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-x1-h3-label-spaced-v2" x="110" y="150">w<tspan class="subscript">13</tspan><tspan class="superscript">(1)</tspan></text> <!-- Above line -->

            <line class="connection-line-ff" id="line-x2-h1-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="50" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-x2-h1-label-spaced-v2" x="110" y="118">w<tspan class="subscript">21</tspan><tspan class="superscript">(1)</tspan></text> <!-- Below line -->

            <line class="connection-line-ff" id="line-x2-h2-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="125" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-x2-h2-label-spaced-v2" x="130" y="155">w<tspan class="subscript">22</tspan><tspan class="superscript">(1)</tspan></text> <!-- Above line, shifted right -->

            <line class="connection-line-ff" id="line-x2-h3-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="200" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-x2-h3-label-spaced-v2" x="110" y="190">w<tspan class="subscript">23</tspan><tspan class="superscript">(1)</tspan></text> <!-- Below line -->

            <!-- Layer 1 -> Layer 2 -->
            <line class="connection-line-ff" id="line-h1-o1-labeled-spaced-v2" x1="215" y1="50" x2="335" y2="125" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-h1-o1-label-spaced-v2" x="265" y="80">w<tspan class="subscript">11</tspan><tspan class="superscript">(2)</tspan></text> <!-- Above line -->

            <line class="connection-line-ff" id="line-h2-o1-labeled-spaced-v2" x1="215" y1="125" x2="335" y2="125" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
             <text class="weight-label-ff interactive-element" id="weight-h2-o1-label-spaced-v2" x="275" y="138">w<tspan class="subscript">21</tspan><tspan class="superscript">(2)</tspan></text> <!-- Below line -->

            <line class="connection-line-ff" id="line-h3-o1-labeled-spaced-v2" x1="215" y1="200" x2="335" y2="125" marker-end="url(#arrowhead-labeled-spaced-v2-default)"/>
            <text class="weight-label-ff interactive-element" id="weight-h3-o1-label-spaced-v2" x="265" y="170">w<tspan class="subscript">31</tspan><tspan class="superscript">(2)</tspan></text> <!-- Above line -->

             <!-- Invisible Click Targets for Lines -->
            <line class="connection-click-target interactive-element" data-targetline="line-x1-h1-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="50"/>
            <line class="connection-click-target interactive-element" data-targetline="line-x1-h2-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="125"/>
            <line class="connection-click-target interactive-element" data-targetline="line-x1-h3-labeled-spaced-v2" x1="65" y1="80" x2="185" y2="200"/>
            <line class="connection-click-target interactive-element" data-targetline="line-x2-h1-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="50"/>
            <line class="connection-click-target interactive-element" data-targetline="line-x2-h2-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="125"/>
            <line class="connection-click-target interactive-element" data-targetline="line-x2-h3-labeled-spaced-v2" x1="65" y1="170" x2="185" y2="200"/>
            <line class="connection-click-target interactive-element" data-targetline="line-h1-o1-labeled-spaced-v2" x1="215" y1="50" x2="335" y2="125"/>
            <line class="connection-click-target interactive-element" data-targetline="line-h2-o1-labeled-spaced-v2" x1="215" y1="125" x2="335" y2="125"/>
            <line class="connection-click-target interactive-element" data-targetline="line-h3-o1-labeled-spaced-v2" x1="215" y1="200" x2="335" y2="125"/>
        </g>
    </svg>

    <!-- Description Area (default text translated) -->
    <div id="description-interactive-ann-labeled-spaced-v2">Klicke auf ein Neuron, eine Verbindungslinie, ein Gewicht (w) oder eine Bias (b)-Beschriftung, um mehr zu erfahren.</div>

    <script>
        // JS with translated descriptions and default text
        (function() {
            const container = document.getElementById('interactive-ann-navigator-labeled-spaced-v2');
            if (!container) return;

            const svg = container.querySelector('#ann-svg-interactive-labeled-spaced-v2');
            const descriptionEl = container.querySelector('#description-interactive-ann-labeled-spaced-v2');
            const interactiveElements = container.querySelectorAll('.interactive-element');

            // Marker URLs
            const defaultMarker = 'url(#arrowhead-labeled-spaced-v2-default)';
            const highlightMarker = 'url(#arrowhead-labeled-spaced-v2-highlight)';
            const defaultBiasMarker = 'url(#arrowhead-bias-spaced-v2-default)';
            const highlightBiasMarker = 'url(#arrowhead-bias-spaced-v2-highlight)';

            // --- Data Mapping (with TRANSLATED descriptions using MathJax) ---
            const elementInfo = {
                 // Neurons
                 'node-x1-labeled-spaced-v2': { type: 'neuron', label: '\\(x_1\\)', outgoingLines: ['line-x1-h1-labeled-spaced-v2', 'line-x1-h2-labeled-spaced-v2', 'line-x1-h3-labeled-spaced-v2'], description: 'Eingabemerkmal \\(x_1\\).' },
                 'node-x2-labeled-spaced-v2': { type: 'neuron', label: '\\(x_2\\)', outgoingLines: ['line-x2-h1-labeled-spaced-v2', 'line-x2-h2-labeled-spaced-v2', 'line-x2-h3-labeled-spaced-v2'], description: 'Eingabemerkmal \\(x_2\\).' },
                 'node-h1-labeled-spaced-v2': { type: 'neuron', label: '\\(a_1^{(1)}\\)', incomingLines: ['line-x1-h1-labeled-spaced-v2', 'line-x2-h1-labeled-spaced-v2'], outgoingLines: ['line-h1-o1-labeled-spaced-v2'], biasId: 'bias-h1-label-spaced-v2', biasArrowId: 'bias-h1-arrow-spaced-v2', description: 'Aktivierung \\(a_1^{(1)}\\) des ersten versteckten Neurons.' },
                 'node-h2-labeled-spaced-v2': { type: 'neuron', label: '\\(a_2^{(1)}\\)', incomingLines: ['line-x1-h2-labeled-spaced-v2', 'line-x2-h2-labeled-spaced-v2'], outgoingLines: ['line-h2-o1-labeled-spaced-v2'], biasId: 'bias-h2-label-spaced-v2', biasArrowId: 'bias-h2-arrow-spaced-v2', description: 'Aktivierung \\(a_2^{(1)}\\) des zweiten versteckten Neurons.' },
                 'node-h3-labeled-spaced-v2': { type: 'neuron', label: '\\(a_3^{(1)}\\)', incomingLines: ['line-x1-h3-labeled-spaced-v2', 'line-x2-h3-labeled-spaced-v2'], outgoingLines: ['line-h3-o1-labeled-spaced-v2'], biasId: 'bias-h3-label-spaced-v2', biasArrowId: 'bias-h3-arrow-spaced-v2', description: 'Aktivierung \\(a_3^{(1)}\\) des dritten versteckten Neurons.' },
                 'node-o1-labeled-spaced-v2': { type: 'neuron', label: '\\(a_1^{(2)}\\)', incomingLines: ['line-h1-o1-labeled-spaced-v2', 'line-h2-o1-labeled-spaced-v2', 'line-h3-o1-labeled-spaced-v2'], outgoingLines: [], biasId: 'bias-o1-label-spaced-v2', biasArrowId: 'bias-o1-arrow-spaced-v2', description: 'Aktivierung \\(a_1^{(2)}\\) des Ausgabe-Neurons.' },

                 // Biases (mapped by label ID)
                 'bias-h1-label-spaced-v2': { type: 'bias', label: '\\(b_1^{(1)}\\)', targetNeuron: 'node-h1-labeled-spaced-v2', arrowId: 'bias-h1-arrow-spaced-v2', description: 'Bias für verstecktes Neuron \\(a_1^{(1)}\\).' },
                 'bias-h2-label-spaced-v2': { type: 'bias', label: '\\(b_2^{(1)}\\)', targetNeuron: 'node-h2-labeled-spaced-v2', arrowId: 'bias-h2-arrow-spaced-v2', description: 'Bias für verstecktes Neuron \\(a_2^{(1)}\\).' },
                 'bias-h3-label-spaced-v2': { type: 'bias', label: '\\(b_3^{(1)}\\)', targetNeuron: 'node-h3-labeled-spaced-v2', arrowId: 'bias-h3-arrow-spaced-v2', description: 'Bias für verstecktes Neuron \\(a_3^{(1)}\\).' },
                 'bias-o1-label-spaced-v2': { type: 'bias', label: '\\(b_1^{(2)}\\)', targetNeuron: 'node-o1-labeled-spaced-v2', arrowId: 'bias-o1-arrow-spaced-v2', description: 'Bias für Ausgabe-Neuron \\(a_1^{(2)}\\).' },

                 // Connections (mapped by line ID)
                 'line-x1-h1-labeled-spaced-v2': { type: 'connection', label: '\\(w_{11}^{(1)}\\)', source: 'node-x1-labeled-spaced-v2', target: 'node-h1-labeled-spaced-v2', weightLabelId: 'weight-x1-h1-label-spaced-v2', description: 'Gewicht von \\(x_1\\) zu \\(a_1^{(1)}\\).' },
                 'line-x1-h2-labeled-spaced-v2': { type: 'connection', label: '\\(w_{12}^{(1)}\\)', source: 'node-x1-labeled-spaced-v2', target: 'node-h2-labeled-spaced-v2', weightLabelId: 'weight-x1-h2-label-spaced-v2', description: 'Gewicht von \\(x_1\\) zu \\(a_2^{(1)}\\).' },
                 'line-x1-h3-labeled-spaced-v2': { type: 'connection', label: '\\(w_{13}^{(1)}\\)', source: 'node-x1-labeled-spaced-v2', target: 'node-h3-labeled-spaced-v2', weightLabelId: 'weight-x1-h3-label-spaced-v2', description: 'Gewicht von \\(x_1\\) zu \\(a_3^{(1)}\\).' },
                 'line-x2-h1-labeled-spaced-v2': { type: 'connection', label: '\\(w_{21}^{(1)}\\)', source: 'node-x2-labeled-spaced-v2', target: 'node-h1-labeled-spaced-v2', weightLabelId: 'weight-x2-h1-label-spaced-v2', description: 'Gewicht von \\(x_2\\) zu \\(a_1^{(1)}\\).' },
                 'line-x2-h2-labeled-spaced-v2': { type: 'connection', label: '\\(w_{22}^{(1)}\\)', source: 'node-x2-labeled-spaced-v2', target: 'node-h2-labeled-spaced-v2', weightLabelId: 'weight-x2-h2-label-spaced-v2', description: 'Gewicht von \\(x_2\\) zu \\(a_2^{(1)}\\).' },
                 'line-x2-h3-labeled-spaced-v2': { type: 'connection', label: '\\(w_{23}^{(1)}\\)', source: 'node-x2-labeled-spaced-v2', target: 'node-h3-labeled-spaced-v2', weightLabelId: 'weight-x2-h3-label-spaced-v2', description: 'Gewicht von \\(x_2\\) zu \\(a_3^{(1)}\\).' },
                 'line-h1-o1-labeled-spaced-v2': { type: 'connection', label: '\\(w_{11}^{(2)}\\)', source: 'node-h1-labeled-spaced-v2', target: 'node-o1-labeled-spaced-v2', weightLabelId: 'weight-h1-o1-label-spaced-v2', description: 'Gewicht von \\(a_1^{(1)}\\) zu \\(a_1^{(2)}\\).' },
                 'line-h2-o1-labeled-spaced-v2': { type: 'connection', label: '\\(w_{21}^{(2)}\\)', source: 'node-h2-labeled-spaced-v2', target: 'node-o1-labeled-spaced-v2', weightLabelId: 'weight-h2-o1-label-spaced-v2', description: 'Gewicht von \\(a_2^{(1)}\\) zu \\(a_1^{(2)}\\).' },
                 'line-h3-o1-labeled-spaced-v2': { type: 'connection', label: '\\(w_{31}^{(2)}\\)', source: 'node-h3-labeled-spaced-v2', target: 'node-o1-labeled-spaced-v2', weightLabelId: 'weight-h3-o1-label-spaced-v2', description: 'Gewicht von \\(a_3^{(1)}\\) zu \\(a_1^{(2)}\\).' },

                  // Weights (mapped by label ID - link back to line)
                 'weight-x1-h1-label-spaced-v2': { type: 'weight', connectionId: 'line-x1-h1-labeled-spaced-v2'},
                 'weight-x1-h2-label-spaced-v2': { type: 'weight', connectionId: 'line-x1-h2-labeled-spaced-v2'},
                 'weight-x1-h3-label-spaced-v2': { type: 'weight', connectionId: 'line-x1-h3-labeled-spaced-v2'},
                 'weight-x2-h1-label-spaced-v2': { type: 'weight', connectionId: 'line-x2-h1-labeled-spaced-v2'},
                 'weight-x2-h2-label-spaced-v2': { type: 'weight', connectionId: 'line-x2-h2-labeled-spaced-v2'},
                 'weight-x2-h3-label-spaced-v2': { type: 'weight', connectionId: 'line-x2-h3-labeled-spaced-v2'},
                 'weight-h1-o1-label-spaced-v2': { type: 'weight', connectionId: 'line-h1-o1-labeled-spaced-v2'},
                 'weight-h2-o1-label-spaced-v2': { type: 'weight', connectionId: 'line-h2-o1-labeled-spaced-v2'},
                 'weight-h3-o1-label-spaced-v2': { type: 'weight', connectionId: 'line-h3-o1-labeled-spaced-v2'},
            };

            let highlightedElements = [];

            function getElement(id) { return svg.querySelector(`#${id}`); }

            function addHighlight(elementId) {
                const element = getElement(elementId);
                 if (element) {
                     element.classList.add('highlight');
                     const info = elementInfo[elementId] || {};
                     if (element.tagName.toLowerCase() === 'line') {
                         if (element.classList.contains('connection-line-ff')) { element.setAttribute('marker-end', highlightMarker); }
                         else if (element.classList.contains('bias-arrow-ff')) { element.setAttribute('marker-end', highlightBiasMarker); }
                     }
                     highlightedElements.push(elementId);
                 }
            }

             function clearAllHighlights() {
                 highlightedElements.forEach(id => {
                     const element = getElement(id);
                     if (element) {
                         element.classList.remove('highlight');
                         if (element.tagName.toLowerCase() === 'line') {
                             if (element.classList.contains('connection-line-ff')) { element.setAttribute('marker-end', defaultMarker); }
                             else if (element.classList.contains('bias-arrow-ff')) { element.setAttribute('marker-end', defaultBiasMarker); }
                         }
                     }
                 });
                 highlightedElements = [];
            }

             function handleInteraction(elementId) {
                 clearAllHighlights();
                 let info = elementInfo[elementId];
                 if (!info) return;
                 let rootElementId = elementId;
                 let rootInfo = info;

                 // If a weight label was clicked, treat it as clicking the connection
                 if (info.type === 'weight' && info.connectionId) {
                     rootElementId = info.connectionId;
                     rootInfo = elementInfo[rootElementId];
                     if (!rootInfo) return; // Should exist
                 }
                 // If a connection click target was clicked, use the actual line's ID
                 if (info.type === 'connection') {
                    // rootElementId = elementId; // Already correct if mapped by line ID
                    rootInfo = info;
                 }


                 let description = rootInfo.description || `Geklickt: ${rootInfo.type} ${rootInfo.label || rootElementId}`; // Fallback German text

                 // Highlight elements based on the 'root' element identified
                 if (rootInfo.type === 'neuron') {
                     addHighlight(rootElementId); // Highlight the neuron itself
                     if (rootInfo.biasId) addHighlight(rootInfo.biasId);
                     if (rootInfo.biasArrowId) addHighlight(rootInfo.biasArrowId);
                     if (rootInfo.incomingLines) rootInfo.incomingLines.forEach(id => { addHighlight(id); const lineInfo = elementInfo[id]; if (lineInfo && lineInfo.weightLabelId) addHighlight(lineInfo.weightLabelId); });
                     if (rootInfo.outgoingLines) rootInfo.outgoingLines.forEach(id => { addHighlight(id); const lineInfo = elementInfo[id]; if (lineInfo && lineInfo.weightLabelId) addHighlight(lineInfo.weightLabelId); });
                     description = `<strong>Aktivierung:</strong> ${rootInfo.label}<br>${rootInfo.description}`;
                 } else if (rootInfo.type === 'bias') {
                     addHighlight(rootElementId); // Highlight the bias label
                     if (rootInfo.arrowId) addHighlight(rootInfo.arrowId);
                     if (rootInfo.targetNeuron) addHighlight(rootInfo.targetNeuron);
                     description = `<strong>Bias:</strong> ${rootInfo.label}<br>${rootInfo.description}`;
                 } else if (rootInfo.type === 'connection') {
                     addHighlight(rootElementId); // Highlight the connection line
                     if (rootInfo.weightLabelId) addHighlight(rootInfo.weightLabelId);
                     if (rootInfo.source) addHighlight(rootInfo.source);
                     if (rootInfo.target) addHighlight(rootInfo.target);
                     description = `<strong>Gewicht:</strong> ${rootInfo.label}<br>${rootInfo.description}`;
                 }

                 descriptionEl.innerHTML = description;
                 // Re-render MathJax for the new description
                 if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                     MathJax.typesetPromise([descriptionEl]);
                 }
            }

             interactiveElements.forEach(element => {
                 element.addEventListener('click', (event) => {
                     event.stopPropagation();
                     let targetId = element.id;
                     // Handle invisible line targets
                     if (element.classList.contains('connection-click-target')) {
                         targetId = element.dataset.targetline;
                     }
                     // Handle clicks on sub-elements like tspan within weight/bias labels if they don't have their own ID
                     if (!targetId && element.parentElement && element.parentElement.classList.contains('interactive-element')) {
                          targetId = element.parentElement.id;
                     }

                     if (targetId && elementInfo[targetId]) {
                         handleInteraction(targetId);
                     } else {
                         // Fallback if somehow an interactive element doesn't map
                         console.warn("Clicked element without info:", element);
                     }
                 });
            });

             svg.addEventListener('click', (event) => {
                  if (event.target === svg || !event.target.closest('.interactive-element')) {
                      clearAllHighlights();
                      // Default description translated
                      descriptionEl.innerHTML = 'Klicke auf ein Neuron, eine Verbindungslinie, ein Gewicht (w) oder eine Bias (b)-Beschriftung, um mehr zu erfahren.';
                  }
             });

             // Initial description translated
             descriptionEl.innerHTML = 'Klicke auf ein Neuron, eine Verbindungslinie, ein Gewicht (w) oder eine Bias (b)-Beschriftung, um mehr zu erfahren.';

        })();
    </script>

</div>
<!-- End: Interactive Network Diagram Navigator (Labeled - Spaced v2) -->
        
        <div class="continue-button" onclick="showNextSection(16)">Weiter</div>
    </section>

    <section id="section16">
        <!-- Header and list items translated -->
        <h2>Zusammenfassung der Lektion</h2>
        <p>Fantastisch! Wir haben nun Neuronen zu Netzwerken zusammengesetzt:</p>
        <ul>
            <li><strong>Schichten:</strong> Netzwerke sind in Eingabe-, Versteckte und Ausgabe-Schichten organisiert.</li>
            <li><strong>Feedforward:</strong> Informationen fließen in eine Richtung, von der Eingabe zur Ausgabe.</li>
            <li><strong>Voll verbunden:</strong> Oft sind alle Neuronen in benachbarten Schichten miteinander verbunden.</li>
            <li><strong>Tiefe:</strong> Netzwerke können mehrere versteckte Schichten haben, was hierarchisches Merkmalslernen ermöglicht.</li>
            <li><strong>Notation:</strong> Wir haben die Notation \(a_j^{(l)}\), \(w_{ij}^{(l)}\), \(b_j^{(l)}\) eingeführt, um Netzwerkkomponenten präzise zu beschreiben.</li>
        </ul>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(17)">Weiter</div>
    </section>

    <section id="section17">
    <div class="test-your-knowledge">
        <!-- Header and question translated -->
        <h3>Teste dein Wissen</h3>
        <h4>Was bedeutet der hochgestellte Index \((2)\) in der Notation \(w_{34}^{(2)}\)?</h4>
        <!-- Options and feedback translated -->
        <div id="option1" class="option-container" onclick="checkAnswer(1, false)">
            <p>Das Gewicht führt zum 2. Neuron in Schicht 3.</p>
            <div id="feedback1" class="option-feedback incorrect-feedback">
                <p>Nicht ganz. Der hochgestellte Index gibt die Zielschicht an.</p>
            </div>
        </div>
        <div id="option2" class="option-container" onclick="checkAnswer(2, false)">
            <p>Das Gewicht kommt vom 2. Neuron in Schicht 1.</p>
            <div id="feedback2" class="option-feedback incorrect-feedback">
                <p>Leider nicht. Der hochgestellte Index ist die Zielschicht, und die tiefgestellten Indizes geben Quell- und Zielneuron an.</p>
            </div>
        </div>
        <div id="option3" class="option-container" onclick="checkAnswer(3, true)">
            <p>Dieses Gewicht ist Teil der Berechnungen für Schicht 2 (verbindet Schicht 1 mit Schicht 2).</p>
            <div id="feedback3" class="option-feedback correct-feedback">
                <p>Genau richtig! Der hochgestellte Index \(l\) in \(w_{ij}^{(l)}\) bezeichnet die Schicht, in die das Gewicht <em>hineinführt</em> (die Zielschicht), d.h., es verbindet Schicht \(l-1\) mit Schicht \(l\).</p>
            </div>
        </div>
        <div id="option4" class="option-container" onclick="checkAnswer(4, false)">
            <p>Dies ist das Gewicht für das 2. Eingabemerkmal insgesamt.</p>
            <div id="feedback4" class="option-feedback incorrect-feedback">
                <p>Knapp daneben. Die Notation bezieht sich auf Verbindungen zwischen Neuronen in spezifischen Schichten, nicht auf allgemeine Eingabemerkmale.</p>
            </div>
        </div>
    </div>
        <!-- Button text translated -->
        <div class="continue-button" onclick="showNextSection(18)">Weiter</div>
    </section>

    <section id="section18">
        <!-- Paragraphs translated -->
        <p>Das Verbinden von Neuronen ist der erste Schritt. Als Nächstes lernen wir, wie wir die Kraft der Linearen Algebra (Matrizen!) nutzen, um die Berechnungen für ganze Schichten effizient durchzuführen.</p>
    </section>


    <script>
        // JS for section reveal, answer reveal remains the same.
        // JS for quiz check remains the same, only HTML text was changed.
        // JS for interactive diagrams updated within their sections.
        document.getElementById("section1").style.display = "block";
        document.getElementById("section1").style.opacity = "1";

        function showNextSection(nextSectionId) {
            const currentButton = event.target;
            const nextSection = document.getElementById("section" + nextSectionId);

            currentButton.style.display = "none";

            nextSection.style.display = "block";
            setTimeout(() => {
                nextSection.style.opacity = "1";
            }, 10);

            setTimeout(() => {
                nextSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 500);

             // Re-render MathJax when a section becomes visible, especially those with dynamic content
             setTimeout(() => {
                if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                     MathJax.typesetPromise([nextSection]);
                }
             }, 50); // Small delay to ensure elements are displayed
        }

        function revealAnswer(id) {
            const revealText = document.getElementById(id);
            const revealButton = event.target;

            revealText.style.display = "block";
            revealButton.style.display = "none";
        }

        function checkAnswer(optionNumber, isCorrect) {
            // Hide all feedback first
            document.querySelectorAll('.option-feedback').forEach(feedback => {
                feedback.style.display = 'none';
                 // Reset background color
                 feedback.parentElement.style.backgroundColor = '';
            });

            // Show the feedback for the selected option
            const feedback = document.getElementById('feedback' + optionNumber);
            feedback.style.display = 'block';

            // Rerender MathJax for the feedback
            if (typeof MathJax !== 'undefined' && MathJax.typesetPromise) {
                 MathJax.typesetPromise([feedback]);
            }

            // Highlight the selected option
            if (isCorrect) {
                document.getElementById('option' + optionNumber).style.backgroundColor = '#d4edda';
            } else {
                document.getElementById('option' + optionNumber).style.backgroundColor = '#f8d7da';
                 // Optionally highlight the correct answer if the user was wrong
                 const correctOptionContainer = document.querySelector('#feedback3').parentElement; // Assumes option 3 is correct
                 if (correctOptionContainer) {
                     correctOptionContainer.style.backgroundColor = '#d4edda';
                     // Show correct feedback as well if desired
                     // document.getElementById('feedback3').style.display = 'block';
                     // MathJax.typesetPromise([document.getElementById('feedback3')]);
                 }
            }
        }
    </script>
</body>
</html>
